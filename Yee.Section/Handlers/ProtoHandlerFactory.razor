@using Yee.Section.Services
@inject SectionState state

@if (Type != null)
{
    <DynamicComponent Type="Type" Parameters="CreateParameters()"></DynamicComponent>
}
else
{
    <div>Прототип @(ProtoType.Name) не имеет реализации</div>
}

@code {

    public Type Type { get; set; }

    [Parameter]
    public Type ProtoType { get; set; }

    [Parameter]
    public EventCallback<object> OnInput { get; set; }

    [Parameter]
    public object InputValue { get; set; }

    protected override void OnInitialized()
    {
        Type = state.ProtoHandlers.FirstOrDefault(p => p.Key == ProtoType).Value;
        base.OnInitialized();
    }

    private Dictionary<string, object> CreateParameters()
    {
        return new Dictionary<string, object>
        {
            {"OnInput", OnInput },
            {"InputValue", InputValue }
        };
    }
}
