@page "/"

@using Microsoft.AspNetCore.Components.Web

<div style="position: fixed; background: white; padding: 12px; z-index: 100; right: 10px; border-radius: 10px; height: inherit;
box-shadow: 0px 0px 30px 0px rgb(82 63 105 / 14%); width: 30rem; ">
    <div style=" font-size: 1.3rem; font-weight: 400;">
        Подключенные модули
    </div>
    @if (Packages.Any() == false)
    {
        <div>Вы не добавили ни одного модуля</div>
    }
    else
    {
        <div style="overflow-y: auto; overflow-x: hidden; padding: 0.6rem 2.2rem; height: 100%; ">
            @foreach (var item in Packages)
            {
                <div style="box-shadow: 0px 0px 30px 0px rgb(82 63 105 / 14%); display: flex; cursor: pointer; border-radius: 6px; padding: 0.6rem 2.2rem; margin-top: 1rem;" @onclick="() => Ref.Select(item)">
                    <dir style="display: flex;padding: 0.3rem 1rem;margin: 0;">
                        <div style=" font-size: 1.2rem; font-weight: 600; overflow-wrap: anywhere;">
                            @item.Id
                        </div>
                        <sup style=" top: 0.2em; font-size: 0.9rem; font-weight: 200; ">
                            @item.Version
                        </sup>
                    </dir>
                </div>
            }
        </div>


        <div style=" position: absolute; bottom: 1rem; width: 100%; display: flex; justify-content: center;">
            <AntDesign.Button type="primary" Style="width: 17rem;">
                Собрать решение
            </AntDesign.Button>
        </div>
    }


</div>

<div style=" padding: 5rem 10%;">
    <Yee.Nuget.WebComponent.NugetClientComponent SelectedList="Packages" OnUpdate="Update" @ref="Ref">

    </Yee.Nuget.WebComponent.NugetClientComponent>
</div>

@code{

    public Yee.Nuget.WebComponent.NugetClientComponent Ref { get; set; }
    public HashSet<NuGet.Packaging.Core.PackageIdentity> Packages { get; set; }

    protected override void OnInitialized()
    {
        Packages = new HashSet<NuGet.Packaging.Core.PackageIdentity>();
        base.OnInitialized();
    }

    private void Update()
    {
        StateHasChanged();
    }
}
